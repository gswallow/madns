<!DOCTYPE html>
<html lang="en">
  <head>
    <title>About madns</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" type="text/css" media="screen" />
  </head>

  <body>
    <h1>madns</h1>

    <p class="lede">
      <b>madns</b> is a mock DNS server intended for developers that returns <em>intentionally invalid results</em>. It was built to test <a href="https://dns.lookup.dog/">dog</a>, a command-line DNS client.
    </p>

    <p>
      The DNS wire format allows several edge cases: messages with the wrong length, records missing required fields, or compressed strings pointing to themselves that could make a naïve client enter an infinite loop.
      DNS clients should handle these cases correctly, but it is difficult to find misbehaving resolvers out in the wild to test against.
      madns lets you run end-to-end tests against such a resolver, to check that you have handled these edge cases correctly.
    </p>

    <p>
      madns will only respond to domain names unsuitable for use on the public Internet, so there’s no chance of it accidentally getting used as a genuine DNS resolver.
      All of its responses are pre-programmed and constructed manually; it does not recurse.
    </p>

    <p>
      Its source code can be found <a href="https://github.com/ogham/madns/" title="The ‘ogham/madns’ project on GitHub.">on GitHub</a>.
    </p>


    <h2 id="usage">Usage <a href="#usage" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      To use madns, make DNS requests to <code>madns.binarystar.systems</code> on port 5301.
    </p>

    <p>
      Requests must contain exactly one query, for a domain name ending in <code>.example</code> or <code>.invalid</code>.
      The record type can be any of the allowed types, and results will vary on both the domain and the type.
      An <code>OPT</code> record in the request won’t affect the results.
    </p>

    <p>
      Any request not satisfying these criteria will be responded to with <code>REFUSED</code>. A request that’s otherwise correct but doesn’t have a valid type/domain combination will be responded to with <code>NOTIMP</code>, rather than <code>NXDOMAIN</code>.
    </p>

    <p>
      It responds to both TCP and UDP requests, though some features are only available using TCP to prevent amplification attacks.
    </p>


    <h2 id="how-to-use">What should I do with this? <a href="#how-to-use" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      If you’re developing a DNS client or a program that uses the DNS protocol in some way, you can point it to this server and have it query one of the domain names listed below, then check that your program behaves according to the specification (or at the very least, doesn’t crash).
    </p>

    <p>
      If you just want to try something quickly, you can test dog’s error handling by resolving one of the domains in the table below. Here’s one that’s valid, the domain <code>txt.example</code>, which contains a string:
    </p>

    <pre role="doc-example"><b>$ dog @madns.binarystar.systems:5301 TXT txt.example</b>
TXT txt.example. 10m00s   "Cache Invalidation and Naming Things"</pre>

    <p>
      And here’s one that’s invalid, <code>empty.txt.invalid</code>, which should result in an error:
    </p>

    <pre role="doc-example"><b>$ dog @madns.binarystar.systems:5301 TXT empty.txt.invalid</b>
Error [protocol]: Malformed packet: insufficient data</pre>


    <h2 id="domains-list">Domains List <a href="#domains-list" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      Here are all the domains madns responds to.
    </p>

    <table>

      <!-- Sample A records -->
      <tr class="section" id="sample-a-records"><th colspan="3">Sample A records <small>(qtype 1)</small> <a href="#sample-a-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/a/a.example.hexit"><code>a.example</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with the <code>127.0.0.1</code> IPv4 address.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/a/too-long.a.invalid.hexit"><code>too-long.a.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with five bytes of IP instead of four.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/a/too-short.a.invalid.hexit"><code>too-short.a.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with three bytes of IP instead of four.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/a/empty.a.invalid.hexit"><code>empty.a.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/a/incomplete.a.invalid.hexit"><code>incomplete.a.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample AAAA records -->
      <tr class="section" id="sample-aaaa-records"><th colspan="3">Sample AAAA records <small>(qtype 28)</small> <a href="#sample-aaaa-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/aaaa/aaaa.example.hexit"><code>aaaa.example</code></a></td>
        <td><code class="qtype aaaa">AAAA</code></td>
        <td>
          Responds with the <code>::1</code> IPv6 address.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/aaaa/too-long.aaaa.invalid.hexit"><code>too-long.aaaa.invalid</code></a></td>
        <td><code class="qtype aaaa">AAAA</code></td>
        <td>
          Responds with fifteen bytes of IP instead of sixteen.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/aaaa/too-short.aaaa.invalid.hexit"><code>too-short.aaaa.invalid</code></a></td>
        <td><code class="qtype aaaa">AAAA</code></td>
        <td>
          Responds with seventeen bytes of IP instead of sixteen.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/aaaa/empty.aaaa.invalid.hexit"><code>empty.aaaa.invalid</code></a></td>
        <td><code class="qtype aaaa">AAAA</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/aaaa/incomplete.aaaa.invalid.hexit"><code>incomplete.aaaa.invalid</code></a></td>
        <td><code class="qtype aaaa">AAAA</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample CAA records -->
      <tr class="section" id="sample-caa-records"><th colspan="3">Sample CAA records <small>(qtype 257)</small> <a href="#sample-caa-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/caa.example.hexit"><code>caa.example</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a valid CAA record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/critical.caa.example.hexit"><code>critical.caa.example</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a valid CAA record with the critical bit set.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/others.caa.example.hexit"><code>others.caa.example</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a valid CAA record all of the currently-unspecified bits set.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/empty.caa.invalid.hexit"><code>empty.caa.invalid</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/incomplete.caa.invalid.hexit"><code>incomplete.caa.invalid</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/utf8.caa.example.hexit"><code>utf8.caa.example</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/caa/bad-utf8.caa.example.hexit"><code>bad-utf8.caa.example</code></a></td>
        <td><code class="qtype caa">CAA</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample CNAME records -->
      <tr class="section" id="sample-cname-records"><th colspan="3">Sample CNAME records <small>(qtype 5)</small> <a href="#sample-cname-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/cname/cname.example.hexit"><code>cname.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a valid CNAME record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/cname/empty.cname.invalid.hexit"><code>empty.cname.invalid</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/cname/incomplete.cname.invalid.hexit"><code>incomplete.cname.invalid</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/cname/utf8.cname.example.hexit"><code>utf8.cname.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/cname/bad-utf8.cname.example.hexit"><code>bad-utf8.cname.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample EUI48 records -->
      <tr class="section" id="sample-eui48-records"><th colspan="3">Sample EUI48 records <small>(qtype 108)</small> <a href="#sample-eui48-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui48/eui48.example.hexit"><code>eui48.example</code></a></td>
        <td><code class="qtype eui48">EUI48</code></td>
        <td>
          Responds with a valid EUI48 record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui48/too-long.eui48.invalid.hexit"><code>too-long.eui48.invalid</code></a></td>
        <td><code class="qtype eui48">EUI48</code></td>
        <td>
          Responds with five bytes of IP instead of six.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui48/too-short.eui48.invalid.hexit"><code>too-short.eui48.invalid</code></a></td>
        <td><code class="qtype eui48">EUI48</code></td>
        <td>
          Responds with seven bytes of IP instead of six.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui48/empty.eui48.invalid.hexit"><code>empty.eui48.invalid</code></a></td>
        <td><code class="qtype eui48">EUI48</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui48/incomplete.eui48.invalid.hexit"><code>incomplete.eui48.invalid</code></a></td>
        <td><code class="qtype eui48">EUI48</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample EUI64 records -->
      <tr class="section" id="sample-eui64-records"><th colspan="3">Sample EUI64 records <small>(qtype 109)</small> <a href="#sample-eui64-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui64/eui64.example.hexit"><code>eui64.example</code></a></td>
        <td><code class="qtype eui64">EUI64</code></td>
        <td>
          Responds with a valid EUI64 record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui64/too-long.eui64.invalid.hexit"><code>too-long.eui64.invalid</code></a></td>
        <td><code class="qtype eui64">EUI64</code></td>
        <td>
          Responds with seven bytes of IP instead of eight.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui64/too-short.eui64.invalid.hexit"><code>too-short.eui64.invalid</code></a></td>
        <td><code class="qtype eui64">EUI64</code></td>
        <td>
          Responds with nine bytes of IP instead of eight.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui64/empty.eui64.invalid.hexit"><code>empty.eui64.invalid</code></a></td>
        <td><code class="qtype eui64">EUI64</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/eui64/incomplete.eui64.invalid.hexit"><code>incomplete.eui64.invalid</code></a></td>
        <td><code class="qtype eui64">EUI64</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample HINFO records -->
      <tr class="section" id="sample-hinfo-records"><th colspan="3">Sample HINFO records <small>(qtype 13)</small> <a href="#sample-hinfo-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/hinfo/hinfo.example.hexit"><code>hinfo.example</code></a></td>
        <td><code class="qtype hinfo">HINFO</code></td>
        <td>
          Responds with a valid HINFO record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/hinfo/empty.hinfo.invalid.hexit"><code>empty.hinfo.invalid</code></a></td>
        <td><code class="qtype hinfo">HINFO</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/hinfo/incomplete.hinfo.invalid.hexit"><code>incomplete.hinfo.invalid</code></a></td>
        <td><code class="qtype hinfo">HINFO</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/hinfo/utf8.hinfo.example.hexit"><code>utf8.hinfo.example</code></a></td>
        <td><code class="qtype hinfo">HINFO</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/hinfo/bad-utf8.hinfo.example.hexit"><code>bad-utf8.hinfo.example</code></a></td>
        <td><code class="qtype hinfo">HINFO</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample LOC records -->
      <tr class="section" id="sample-loc-records"><th colspan="3">Sample LOC records <small>(qtype 29)</small> <a href="#sample-loc-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/loc.example.hexit"><code>loc.example</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a valid LOC record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/far-negative-longitude.loc.invalid.hexit"><code>far-negative-longitude.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the longitude field out-of-range, too far into the negative.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/far-positive-longitude.loc.invalid.hexit"><code>far-positive-longitude.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the longitude field out-of-range, too far into the positive.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/far-negative-latitude.loc.invalid.hexit"><code>far-negative-latitude.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the latitude field out-of-range, too far into the negative.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/far-positive-latitude.loc.invalid.hexit"><code>far-positive-latitude.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the longitude field out-of-range, too far into the positive.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/v1-conform.loc.invalid.hexit"><code>v1-conform.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the version number set to 1, rather than 0, but the rest of the record holds data in the version 0 format.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/v1-nonconform.loc.invalid.hexit"><code>v1-nonconform.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the version number set to 1, rather than 0, and the rest of the record holds random data.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/v1-empty.loc.invalid.hexit"><code>v1-empty.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a packet with the version number set to 1, rather than 0, with the rest of the record empty.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/empty.loc.invalid.hexit"><code>empty.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/loc/incomplete.loc.invalid.hexit"><code>incomplete.loc.invalid</code></a></td>
        <td><code class="qtype loc">LOC</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample MX records -->
      <tr class="section" id="sample-mx-records"><th colspan="3">Sample MX records <small>(qtype 15)</small> <a href="#sample-mx-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/mx/mx.example.hexit"><code>mx.example</code></a></td>
        <td><code class="qtype mx">MX</code></td>
        <td>
          Responds with a valid MX record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/mx/empty.mx.invalid.hexit"><code>empty.mx.invalid</code></a></td>
        <td><code class="qtype mx">MX</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/mx/incomplete.mx.invalid.hexit"><code>incomplete.mx.invalid</code></a></td>
        <td><code class="qtype mx">MX</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/mx/utf8.mx.example.hexit"><code>utf8.mx.example</code></a></td>
        <td><code class="qtype mx">MX</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/mx/bad-utf8.mx.example.hexit"><code>bad-utf8.mx.example</code></a></td>
        <td><code class="qtype mx">MX</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample NAPTR records -->
      <tr class="section" id="sample-naptr-records"><th colspan="3">Sample NAPTR records <small>(qtype 35)</small> <a href="#sample-naptr-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/naptr.example.hexit"><code>naptr.example</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a valid NAPTR record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/bad-regex.naptr.example.hexit"><code>bad-regex.naptr.example</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a valid NAPTR record containing an invalid regular expression.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/empty.naptr.invalid.hexit"><code>empty.naptr.invalid</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/incomplete.naptr.invalid.hexit"><code>incomplete.naptr.invalid</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/utf8.naptr.invalid.hexit"><code>utf8.naptr.invalid</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/naptr/bad-utf8.naptr.invalid.hexit"><code>bad-utf8.naptr.invalid</code></a></td>
        <td><code class="qtype naptr">NAPTR</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample NS records -->
      <tr class="section" id="sample-ns-records"><th colspan="3">Sample NS records <small>(qtype 2)</small> <a href="#sample-ns-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ns/ns.example.hexit"><code>ns.example</code></a></td>
        <td><code class="qtype ns">NS</code></td>
        <td>
          Responds with a valid NS record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ns/empty.ns.invalid.hexit"><code>empty.ns.invalid</code></a></td>
        <td><code class="qtype ns">NS</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ns/incomplete.ns.invalid.hexit"><code>incomplete.ns.invalid</code></a></td>
        <td><code class="qtype ns">NS</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ns/utf8.ns.example.hexit"><code>utf8.ns.example</code></a></td>
        <td><code class="qtype ns">NS</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ns/bad-utf8.ns.example.hexit"><code>bad-utf8.ns.example</code></a></td>
        <td><code class="qtype ns">NS</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample OPENPGPKEY records -->
      <tr class="section" id="sample-openpgpkey-records"><th colspan="3">Sample OPENPGPKEY records <small>(qtype 61)</small> <a href="#sample-openpgpkey-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/openpgpkey/openpgpkey.example.hexit"><code>openpgpkey.example</code></a></td>
        <td><code class="qtype hinfo"><small>OPENPGPKEY</small></code></td>
        <td>
          Responds with a valid OPENPGPKEY record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/openpgpkey/empty.openpgpkey.invalid.hexit"><code>empty.openpgpkey.invalid</code></a></td>
        <td><code class="qtype openpgpkey"><small>OPENPGPKEY</small></code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/openpgpkey/incomplete.openpgpkey.invalid.hexit"><code>incomplete.openpgpkey.invalid</code></a></td>
        <td><code class="qtype openpgpkey"><small>OPENPGPKEY</small></code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample OPT records -->
      <tr class="section" id="sample-opt-records"><th colspan="3">Sample OPT records <small>(qtype 41)</small> <a href="#sample-opt-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/opt/opt.example.hexit"><code>opt.example</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with an A record, along with a valid OPT record in the Additional section.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/opt/do-flag.opt.example.hexit"><code>do-flag.opt.example</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with an A record, along with a valid OPT record in the Additional section that has the DO flag set.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/opt/other-flags.opt.example.hexit"><code>other-flags.opt.example</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with an A record, along with a valid OPT record in the Additional section that has all the currently-unspecified flags set.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/opt/incomplete.opt.invalid.hexit"><code>incomplete.opt.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with an OPT record in the Additional section that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/opt/named.opt.invalid.hexit"><code>named.opt.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a record that has an OPT record under a domain other than the root domain in the Additional section.
        </td>
      </tr>


      <!-- Sample PTR records -->
      <tr class="section" id="sample-ptr-records"><th colspan="3">Sample PTR records <small>(qtype 12)</small> <a href="#sample-ptr-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ptr/ptr.example.hexit"><code>ptr.example</code></a></td>
        <td><code class="qtype ptr">PTR</code></td>
        <td>
          Responds with a valid PTR record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ptr/empty.ptr.invalid.hexit"><code>empty.ptr.invalid</code></a></td>
        <td><code class="qtype ptr">PTR</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ptr/incomplete.ptr.invalid.hexit"><code>incomplete.ptr.invalid</code></a></td>
        <td><code class="qtype ptr">PTR</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ptr/utf8.ptr.example.hexit"><code>utf8.ptr.example</code></a></td>
        <td><code class="qtype ptr">PTR</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/ptr/bad-utf8.ptr.example.hexit"><code>bad-utf8.ptr.example</code></a></td>
        <td><code class="qtype ptr">PTR</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample SOA records -->
      <tr class="section" id="sample-soa-records"><th colspan="3">Sample SOA records <small>(qtype 6)</small> <a href="#sample-soa-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/soa/soa.example.hexit"><code>soa.example</code></a></td>
        <td><code class="qtype soa">SOA</code></td>
        <td>
          Responds with a valid SOA record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/soa/empty.soa.invalid.hexit"><code>empty.soa.invalid</code></a></td>
        <td><code class="qtype soa">SOA</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/soa/incomplete.soa.invalid.hexit"><code>incomplete.soa.invalid</code></a></td>
        <td><code class="qtype soa">SOA</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/soa/utf8.soa.example.hexit"><code>utf8.soa.example</code></a></td>
        <td><code class="qtype soa">SOA</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/soa/bad-utf8.soa.example.hexit"><code>bad-utf8.soa.example</code></a></td>
        <td><code class="qtype soa">SOA</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample SRV records -->
      <tr class="section" id="sample-srv-records"><th colspan="3">Sample SRV records <small>(qtype 33)</small> <a href="#sample-srv-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/srv/srv.example.hexit"><code>srv.example</code></a></td>
        <td><code class="qtype srv">SRV</code></td>
        <td>
          Responds with a valid SRV record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/srv/empty.srv.invalid.hexit"><code>empty.srv.invalid</code></a></td>
        <td><code class="qtype srv">SRV</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/srv/incomplete.srv.invalid.hexit"><code>incomplete.srv.invalid</code></a></td>
        <td><code class="qtype srv">SRV</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/srv/utf8.srv.example.hexit"><code>utf8.srv.example</code></a></td>
        <td><code class="qtype srv">SRV</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/srv/bad-utf8.srv.example.hexit"><code>bad-utf8.srv.example</code></a></td>
        <td><code class="qtype srv">SRV</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Sample SSHFP records -->
      <tr class="section" id="sample-sshfp-records"><th colspan="3">Sample SSHFP records <small>(qtype 44)</small> <a href="#sample-sshfp-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/sshfp/sshfp.example.hexit"><code>sshfp.example</code></a></td>
        <td><code class="qtype sshfp">SSHFP</code></td>
        <td>
          Responds with a valid SSHFP record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/sshfp/empty.sshfp.invalid.hexit"><code>empty.sshfp.invalid</code></a></td>
        <td><code class="qtype sshfp">SSHFP</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/sshfp/incomplete.sshfp.invalid.hexit"><code>incomplete.sshfp.invalid</code></a></td>
        <td><code class="qtype sshfp">SSHFP</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample TLSA records -->
      <tr class="section" id="sample-tlsa-records"><th colspan="3">Sample TLSA records <small>(qtype 52)</small> <a href="#sample-tlsa-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/tlsa/tlsa.example.hexit"><code>tlsa.example</code></a></td>
        <td><code class="qtype tlsa">TLSA</code></td>
        <td>
          Responds with a valid TLSA record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/tlsa/empty.tlsa.invalid.hexit"><code>empty.tlsa.invalid</code></a></td>
        <td><code class="qtype tlsa">TLSA</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/tlsa/incomplete.tlsa.invalid.hexit"><code>incomplete.tlsa.invalid</code></a></td>
        <td><code class="qtype tlsa">TLSA</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample TXT records -->
      <tr class="section" id="sample-txt-records"><th colspan="3">Sample TXT records <small>(qtype 16)</small> <a href="#sample-txt-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/txt.example.hexit"><code>txt.example</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a valid TXT record containing one string of text.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/utf8.txt.example.hexit"><code>utf8.txt.example</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a valid TXT record containing some UTF-8 text.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/bad-utf8.txt.example.hexit"><code>bad-utf8.txt.example</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a valid TXT record containing some invalid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/limit.txt.example.hexit"><code>limit.txt.example</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a valid TXT record containing exactly 255 bytes of text.
          <i>Only available over TCP.</i>
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/multiple.txt.example.hexit"><code>multiple.txt.example</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a valid TXT record containing two internal strings of text.
          <i>Only available over TCP.</i>
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/missing-data.txt.invalid.hexit"><code>missing-data.txt.invalid</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a record containing zero bytes of text, as zero internal strings.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/missing-text.txt.invalid.hexit"><code>missing-text.txt.invalid</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a record containing zero bytes of text, as one internal string that contains zero bytes.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/empty.txt.invalid.hexit"><code>empty.txt.invalid</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/txt/incomplete.txt.invalid.hexit"><code>incomplete.txt.invalid</code></a></td>
        <td><code class="qtype txt">TXT</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>


      <!-- Sample URI records -->
      <tr class="section" id="sample-uri-records"><th colspan="3">Sample URI records <small>(qtype 256)</small> <a href="#sample-uri-records" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/uri.example.hexit"><code>uri.example</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record with <code>https://rfcs.io/</code> as the URI.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/slash.uri.example.hexit"><code>slash.uri.example</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record with <code>/</code> as the URI.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/missing-data.uri.invalid.hexit"><code>missing-data.uri.invalid</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record with priority and weight, but zero bytes of URI.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/empty.uri.invalid.hexit"><code>empty.uri.invalid</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a zero-length record.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/incomplete.uri.invalid.hexit"><code>incomplete.uri.invalid</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record that has some bytes missing.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/utf8.uri.example.hexit"><code>utf8.uri.example</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record containing some bytes that happen to be valid UTF-8.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/uri/bad-utf8.uri.example.hexit"><code>bad-utf8.uri.example</code></a></td>
        <td><code class="qtype uri">URI</code></td>
        <td>
          Responds with a record containing invalid UTF-8 bytes.
        </td>
      </tr>


      <!-- Random responses -->
      <tr class="section" id="random-responses"><th colspan="3">Random responses <a href="#random-responses" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><code>random-data.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with several dozen bytes of random data, with no regard for correct DNS packet structure. Could be anything! <i>Only available over TCP.</i>
        </td>
      </tr>

      <tr>
        <td><code>random-records.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with several packets with random qtypes, lengths, and contents, using the correct DNS packet structure. <i>Only available over TCP.</i>
        </td>
      </tr>


      <!-- Oddball characters in domain names -->
      <tr class="section" id="oddball-characters"><th colspan="3">Oddball characters in domain names <a href="#oddball-characters" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-chars/ansi.str.example.hexit"><code>ansi.str.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a domain name containing ANSI escape codes.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-chars/newline.str.example.hexit"><code>newline.str.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a domain name containing newline characters.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-chars/null.str.example.hexit"><code>null.str.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a domain name containing null bytes.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-chars/tab.str.example.hexit"><code>tab.str.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a domain name containing tab characters.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-chars/upperbit.str.example.hexit"><code>upperbit.str.example</code></a></td>
        <td><code class="qtype cname">CNAME</code></td>
        <td>
          Responds with a domain name containing bytes with the upper bit set (characters in the range 128 to 255).
        </td>
      </tr>


      <!-- Malicious string compression -->
      <tr class="section" id="malicious-string-compression"><th colspan="3">Malicious string compression <a href="#malicious-string-compression" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/out-of-range.invalid.hexit"><code>out-of-range.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a compressed domain name that points outside the packet.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/recursive-1.invalid.hexit"><code>recursive-1.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a compressed domain name that points to itself.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/recursive-2.invalid.hexit"><code>recursive-2.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a compressed domain name that points to another part of the packet, which points back to the original domain name location.
        </td>
      </tr>


      <!-- Unusual packet structure -->
      <tr class="section" id="unusual-packet-structure"><th colspan="3">Unusual packet structure <a href="#unusual-packet-structure" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/completely-empty.invalid.hexit"><code>completely-empty.invalid</code></a></td>
        <td><i>(any)</i></td>
        <td>
          Responds with a DNS packet containing no records.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/missing-answers.invalid.hexit"><code>missing-answers.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a DNS packet containing the original question, but no answers.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-proto/trailing-data.invalid.hexit"><code>trailing-data.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a DNS packet containing no records, but with some trailing bytes at the end.
        </td>
      </tr>

      <tr>
        <td><code>truncated.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with a DNS packet containing no records, but with the ‘Truncated’ bit set in the header.
        </td>
      </tr>


      <!-- Errors -->
      <tr class="section" id="errors"><th colspan="3">Errors <a href="#errors" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><code>formerr.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with the <code>FormErr</code> error status and no records. This usually happens when the server is unable to interpret the query.
        </td>
      </tr>

      <tr>
        <td><code>servfail.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with the <code>ServFail</code> error status and no records. This usually happens when there’s something wrong with the server.
        </td>
      </tr>

      <tr>
        <td><code>nxdomain.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with the <code>NXDomain</code> error status and no records. This usually happens when the domain name referenced in the query does not exist.
        </td>
      </tr>

      <tr>
        <td><code>notimp.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with the <code>NotImp</code> error status and no records. This usually happens when the server does not support one of the requested features.
        </td>
      </tr>

      <tr>
        <td><code>refused.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with the <code>Refused</code> error status and no records. This usually happens when the server refuses to answer the query for whatever reason.
        </td>
      </tr>

      <tr>
        <td><code>other-error.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with an error status with no currently-defined meaning.
        </td>
      </tr>

      <tr>
        <td><code>private-error.invalid</code></td>
        <td><i>(any)</i></td>
        <td>
          Responds with an error status within the “Reserved for Private Use” range.
        </td>
      </tr>


      <!-- Question mismatches -->
      <tr class="section" id="question-mismatches"><th colspan="3">Question mismatches <a href="#question-mismatches" title="Link to this section" aria-hidden="true">§</a></th></tr>
      <tr class="headings">
        <th>Domain</th>
        <th>qtype</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-retry/domain-mismatch.invalid.hexit"><code>domain-mismatch.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a DNS packet where the domain in the Question field is different from the one in the request.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-retry/qclass-mismatch.invalid.hexit"><code>qclass-mismatch.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a DNS packet where the record type in the Question field is different from the one in the request.
        </td>
      </tr>

      <tr>
        <td><a title="View the Hexit source for this record" href="https://github.com/ogham/madns/blob/master/samples/special-retry/qtype-mismatch.invalid.hexit"><code>qtype-mismatch.invalid</code></a></td>
        <td><code class="qtype a">A</code></td>
        <td>
          Responds with a DNS packet where the DNS class in the Question field is different from the one in the request.
        </td>
      </tr>

    </table>


    <h2 id="example-and-invalid">What’s the difference between the .example and .invalid TLDs? <a href="#example-and-invalid" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      There are two TLDs that madns responds to:
    </p>

    <ul>
      <li>Responses to <code>*.example</code> domains will have a correct DNS packet structure, and each record will be valid as well. Your client should parse these packets correctly. The data inside the records may be invalid for non-DNS reasons, but the packet structure will be correct.</li>
      <li>Responses to <code>*.invalid</code> domains will have an <em>incorrect</em> DNS packet structure, or invalid record structures. Your client should detect these responses as malformed.</li>
    </ul>


    <h2 id="invalid-length-domains">What’s the difference between all the invalid length domains? <a href="#invalid-length-domains" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      DNS packets can be valid or invalid in several ways.
      Each response packet contains several records, and each record has its length specified.
    </p>

    <ul>
      <li><code>empty.*.invalid</code> responses will have the record length in the packet set to zero, and each record will contain no data.</li>
      <li><code>incomplete.*.invalid</code> responses will have the record length in the packet set to a <em>non-zero</em> value, but the packet will end before this number of bytes have been read.
      <li><code>too-long.*.invalid</code> and <code>too-short.*.invalid</code> responses are only applicable to record types that have a fixed length (such as 4 for <code>A</code> or 16 for <code>AAAA</code>). The record length in the packet will correctly refer to the number of bytes in the packet, even though this number differs from the length according to the specification (it’s the correct incorrect length).
      <li><code>missing-data.*.invalid</code> responses will have a missing variable-length string, but all other parts of the record will be present. Whether this is invalid or not depends on the record type. The record length in the packet will be correct.
    </ul>

    <p>
      DNS packets sent over TCP must be prefixed with the length of the packet. No matter which domain is queried, this length will <em>always</em> be correct, as getting it wrong results in connections hanging open rather than protocol parse errors.
    </p>


    <h2 id="why-utf8">Why the UTF-8 records? Doesn’t DNS specify ASCII? <a href="#why-utf8" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      That’s correct — DNS specifies that data within records should use ASCII, and interpreting their contents as UTF-8 is the wrong thing to do.
      For example, the contents of a TXT record should be treated as ASCII, and any bytes with the upper bit set should be escaped and displayed as bytes, <em>not</em> as UTF-8 characters.
    </p>

    <p>
      However, now that UTF-8 has become the One True Standard for text encoding (and rightfully so), it’s easy for clients to treat any text UTF-8, and do this by accident.
      There is nothing stopping DNS servers from returning record data containing bytes with the upper bit set, even if it does violate the specification, and this needs to be handled by clients <em>somehow</em>.
      The <code>utf8.*</code> and <code>bad-utf.*</code> records are present so that clients can make sure they do not attempt to do this; or worse, that they do not crash when presented with invalid UTF-8 bytes.
    </p>


    <h2 id="other-resources">Other resources <a href="#other-resources" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      There exists a draft RFC, <a href="https://datatracker.ietf.org/doc/draft-dashevskyi-dnsrr-antipatterns/" title="“Common implementation anti-patterns related to Domain Name System (DNS) resource record (RR) processing” on the IETF website.">draft-dashevskyi-dnsrr-antipatterns-00</a>, that lists several mistakes found in software which processes the DNS wire format.
    </p>


    <h2 id="support">Support <a href="#support" title="Link to this section" aria-hidden="true">§</a></h2>

    <p>
      madns and dog is maintained by <a href="https://bsago.me/">Benjamin Sago</a>.
    </p>

    <p>
      Note that madns comes with <em>no SLA or anything like that</em> — it may go down at any time without warning. Despite that proviso, I hope you find it useful.
    </p>

  </body>
</html>
